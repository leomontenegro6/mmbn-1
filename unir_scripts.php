<?php

// Ler parâmetros passados na linha de comando
$arguments = $argv;
array_shift($arguments);
$arguments = array_map('trim', $arguments);
$version = $arguments[0] ?? 'g';

if (!in_array($version, ['g', 'c'])) {
    echo "Versão inválida. Use 'g' para GBA ou 'c' para Coletânea.\n";
    exit(1);
}

// Obtendo lista de offsets para uso posterior, dependendo da versão.
if ($version == 'c') {
    // Versão da Coletânea.
    $offsets = [
        "640014", "64015C", "69B6D4", "69C3D8", "69DEB4", "69E414", "69F118",
        "69F12C", "6A0900", "6A1C44", "6A2E54", "6A423C", "6A5144", "6A604C",
        "6A70F8", "6A81D8", "6A92C0", "6AA0C0", "6AAE94", "6AB75C", "6AC530",
        "6AD300", "6AE0C8", "6AF06C", "6AFFF0", "6B0C90", "6B1934", "6B26B4",
        "6B343C", "6B4084", "6B4DD8", "6B5224", "6B5F10", "6B6BF4", "6B7910",
        "6B8618", "6B9320", "6BA030", "6BAC8C", "6BB804", "6BC354", "6BCEA4",
        "6BDA78", "6BE508", "6BF038", "6BFB28", "6C0618", "6C1108", "6C1BFC",
        "6C2684", "6C2FF8", "6C39AC", "6C43A0", "6C4D94", "6C571C", "6C5AA0",
        "6C5E88", "6C66E4", "6C6ACC", "6C6EB4", "6C729C", "6C7388", "6C7468",
        "6C7524", "6C75E4", "6C768C", "6C77A0", "6C7850", "6C7BCC", "6C7F48",
        "6C82C4", "6C8640", "6C8908", "6C8BD0", "6C8EFC", "6C9228", "6C9554",
        "6C9880", "6C9B88", "6C9EFC", "6CA270", "6CA5E4", "6CA94C", "6CAD70",
        "6CB194", "6CB5B8", "6CB9DC", "6CBE00", "6CC1E8", "6CCE88", "6CDA58",
        "6CE700", "6CF2C0", "6CFE14", "6D096C", "6D13D0", "6D1D0C", "6D1D60",
        "6D1DC8", "6D1E34", "6D1E94", "6D1EEC", "6D1FD8", "6D2028", "6D2088",
        "6D20DC", "6D2130", "6D2188", "6D21D8", "6D2238", "6D2E94", "6D3A18",
        "6D453C", "6D4F84", "6D56A0", "6D5DBC", "6D64D8", "6D6BF4", "6D6C70",
        "6D6CEC", "6D6D68", "6D6DE4", "6D6E60", "6D6EDC", "6D6F58", "6D6FD4",
        "6D9748", "6D9F98", "6DA868", "6DB0F0", "6DB754", "6DC1C8", "6DCB38",
        "6DD398", "6DDAD4", "6DDF8C", "6DE924", "6DF0DC", "6DF750", "6E2AC8",
        "6E3204", "6E3FC4", "6E48D4", "6E4DF4", "6E5474", "6E6218", "6E6E68",
        "6E801C", "6E941C", "6E97C8", "6EAEEC", "6EB820", "6ECFE0", "6EEAFC",
        "6EFEF0", "6F0BEC", "6F1BFC", "6F2468", "6F2EB4", "6F41BC", "6F49B4",
        "6F5340", "6F5AA4", "6F6688", "6F6D94", "6F775C", "6F88AC", "6F8FE0",
        "6F9ED8", "6FA4C0", "6FB1F8", "6FB858", "6FB88C", "6FC044", "6FC8CC",
        "6FC934", "6FCEE0", "6FD110", "6FD51C", "6FD984", "6FE238", "6FE9E4",
        "6FF184", "6FF7E8", "700514", "7007C8", "700A34", "700E20", "701140",
        "7011B4", "7014FC", "70173C", "701A48", "701BF0", "701E08", "701FAC",
        "702494", "703F30", "705914", "70722C", "708AB0", "708F84", "7097B8",
        "709920", "709A30", "709C80", "709D68", "709EBC", "70A1F8", "70A594",
        "70A7C8", "70AC68", "70AE9C", "70B0D0", "70B300", "70B478", "70B5BC",
        "70B71C", "70B8DC", "70BA54", "70BC50", "70BD8C", "70BFA4", "70C13C",
        "70C2CC", "70C3DC", "70C548", "70C6B0", "70D7A0", "70E3FC", "70EB8C",
        "70F38C", "70FB0C", "70FF8C", "71040C", "710778", "710C74", "711424",
        "711990", "711DA4", "712260", "712898", "712E60", "713414", "713680",
        "713900", "713C40", "713EC8", "713F4C", "714104", "714164", "714214",
        "7142DC", "7144C4", "714520", "71463C", "7148BC", "714AF0", "714E34",
        "714EE8", "714FE8", "7151A0", "715478", "7159BC", "715C90", "715D70",
        "715DDC", "715F10", "715F6C", "715FB4", "716278", "716504", "716728",
        "716898", "716BF4", "716E08", "716EDC", "717070", "7171C8", "7172DC",
        "7173C4", "7175E8", "717AAC", "717C54", "717D88", "717F8C", "718094",
        "71847C", "71858C", "7185E0", "718948", "718BA4", "718DD8", "719244",
        "7194B8", "719824", "719B28", "71A028", "71A180", "71A2F4", "71A418",
        "71A56C", "71A5D4", "71A824", "71AA60", "71AAAC", "71AB58", "71ADC0",
        "71AE38", "71AEB8", "71AF14", "71AF8C", "71AFEC", "71B028", "71B040",
        "71B05C", "71B080", "71B3B8", "71B580", "71B658", "71B8B0", "71BA9C",
        "71BDF4", "71C038", "71C158", "71C304", "71C578", "71C858", "71CD78",
        "71CE90", "71D1DC", "71D380", "71D548", "71D5B0", "71D64C", "71D78C",
        "71D8A8", "71D9C8", "71DCA8", "71E02C", "71E0B0", "71E2D8", "71E6B8",
        "71E914", "71EBC0", "71EDE4", "71EF74", "71F198", "71F3B8", "71F560",
        "71F62C", "71F7E0", "71F9B8", "71FCDC", "71FD80", "71FED8", "71FF48",
        "7200C8", "72026C", "7203DC", "72051C", "720734", "720CCC", "720ECC",
        "721D3C", "7221F4", "7227C0", "72297C", "722A90", "722AB4", "722AF4",
        "72355C", "723DD4", "724600", "724924", "7BE828", "7BF3DC", "7BFB40",
        "7C19FC", "7C1D38", "7C3C10", "7C3E40", "7C4090", "7C42B4", "7C438C",
    ];
} else {
    // Versão de GBA.
    $offsets = [
        "641FCC", "6420C0", "69D57C", "69E310", "69FD50", "6A0118", "6A0D50",
        "6A0D5C", "6A2A24", "6A416C", "6A571C", "6A6F3C", "6A8154", "6A936C",
        "6AA7AC", "6ABC40", "6AD0D4", "6AE1F4", "6AF2D8", "6AFCD8", "6B0DBC",
        "6B1EB0", "6B2F9C", "6B42FC", "6B5614", "6B655C", "6B749C", "6B8510",
        "6B9588", "6BA440", "6BB4AC", "6BB938", "6BC90C", "6BD8DC", "6BE8CC",
        "6BF8C8", "6C08C8", "6C18A0", "6C2784", "6C354C", "6C42CC", "6C504C",
        "6C5F10", "6C6BAC", "6C7900", "6C863C", "6C9374", "6CA0B0", "6CAE08",
        "6CBA8C", "6CC570", "6CD0A8", "6CDC2C", "6CE7B0", "6CF2AC", "6CF65C",
        "6CFA54", "6CFEA8", "6D02A0", "6D0698", "6D0A90", "6D0BAC", "6D0CC0",
        "6D0DB0", "6D0EA8", "6D0F74", "6D10B8", "6D117C", "6D1564", "6D194C",
        "6D1D34", "6D211C", "6D2434", "6D274C", "6D2AA4", "6D2DFC", "6D3154",
        "6D34AC", "6D37D4", "6D3B64", "6D3EF4", "6D4284", "6D4620", "6D4A7C",
        "6D4ED8", "6D5334", "6D5790", "6D5BEC", "6D5FEC", "6D6FD8", "6D7E78",
        "6D8E68", "6D9CF4", "6DAAEC", "6DB918", "6DC608", "6DD110", "6DD180",
        "6DD218", "6DD2A4", "6DD314", "6DD37C", "6DD494", "6DD4F0", "6DD570",
        "6DD5E0", "6DD644", "6DD6B0", "6DD714", "6DD788", "6DE71C", "6DF57C",
        "6E0354", "6E1000", "6E182C", "6E2058", "6E2884", "6E30B0", "6E3158",
        "6E3200", "6E32A8", "6E3350", "6E33F8", "6E34A0", "6E3548", "6E35F0",
        "6E6934", "6E7288", "6E7D14", "6E86E8", "6E8E0C", "6E9A08", "6EA518",
        "6EAEC8", "6EB730", "6EBC18", "6EC6E0", "6ECFA0", "6ED680", "6F1564",
        "6F1DC4", "6F2DD4", "6F3818", "6F3DC4", "6F44DC", "6F5504", "6F6330",
        "6F76A4", "6F8DD4", "6F9180", "6FAD74", "6FB7E0", "6FD444", "6FF324",
        "700A24", "7018DC", "702C94", "70365C", "704314", "7059CC", "70633C",
        "706F5C", "707858", "708714", "708F68", "709B74", "70B100", "70B968",
        "70CC20", "70D268", "70E1E0", "70E920", "70E964", "70F288", "70FCE4",
        "70FD4C", "7101B8", "71047C", "710740", "710BAC", "7111C8", "711BB4",
        "712448", "712D28", "713478", "71440C", "7146AC", "71496C", "714E28",
        "715198", "715208", "7155F4", "715884", "715C34", "715E10", "71605C",
        "716230", "716838", "71862C", "71A378", "71BFEC", "71DB7C", "71E07C",
        "71E9A4", "71EB08", "71EC20", "71EEE4", "71EFEC", "71F154", "71F4D4",
        "71F8E8", "71FB4C", "7200AC", "720314", "720584", "7207E4", "7209D0",
        "720B4C", "720D18", "720F24", "7210EC", "721338", "7214EC", "721724",
        "7218D8", "721A94", "721BD8", "721DB4", "721F40", "723318", "724040",
        "7248D4", "7251F0", "7259F4", "725E68", "7262DC", "72663C", "726B6C",
        "7273AC", "727944", "727DA0", "72829C", "728948", "728F50", "72954C",
        "729828", "729B94", "729FB8", "72A2AC", "72A350", "72A598", "72A618",
        "72A700", "72A81C", "72AA60", "72AAEC", "72AC28", "72AF48", "72B200",
        "72B5E0", "72B6E4", "72B838", "72BA98", "72BE64", "72C508", "72C8B4",
        "72C9A4", "72CA30", "72CB9C", "72CC0C", "72CC5C", "72CF9C", "72D2B0",
        "72D540", "72D6DC", "72DA84", "72DD40", "72DE60", "72E050", "72E244",
        "72E3B0", "72E4DC", "72E790", "72EB2C", "72ED28", "72EEB8", "72F120",
        "72F274", "72F74C", "72F8A4", "72F914", "72FD2C", "73000C", "730278",
        "7307E4", "730AB8", "730ED0", "731238", "731844", "7319C4", "731B94",
        "731D10", "731EC0", "731F40", "732240", "7324D4", "732534", "7325FC",
        "732928", "7329C8", "732A70", "732AE8", "732B78", "732C00", "732C4C",
        "732C70", "732C94", "732CB8", "7330EC", "73336C", "733488", "73379C",
        "7339E4", "733E60", "734140", "7342C8", "734504", "734834", "734C54",
        "7352BC", "735404", "7357D4", "7359B8", "735BBC", "735C4C", "735D08",
        "735E88", "735FE8", "736168", "736508", "7369F0", "736AA4", "736D84",
        "73724C", "737530", "73783C", "737A8C", "737C98", "737F28", "7381B8",
        "7383DC", "7384D4", "7386F8", "73896C", "738D78", "738E3C", "738FF0",
        "739078", "739260", "739450", "739628", "739778", "7399FC", "73A0CC",
        "73A2F0", "73B350", "73B88C", "73BF18", "73C0EC", "73C238", "73C270",
        "73C2AC", "73D0C0", "73DC18", "73E640", "73E9A0", "7A7084", "7A7F48",
        "7A83C8", "7AA6F8", "7AAA90", "7AC9B8", "7ACC24", "7ACEBC", "7AD148",
        "7AD220",
    ];
}

// Iterando pelos offsets e abrindo os arquivos correspondentes.
$contents = '';
foreach ($offsets as $i => $offset) {
    $number = str_pad(($i + 1), 3, '0', STR_PAD_LEFT);
    $folder = ($version == 'c') ? ('Coletanea') : ('GBA');
    $file_name = "Scripts/Editados/{$folder}/{$number}.tpl";
    if (file_exists($file_name)) {
        $contents .= "@archive $offset\n";
        $contents .= file_get_contents($file_name);
    } else {
        echo "Arquivo não encontrado: $file_name\n";
    }
}

// Salvando o conteúdo combinado em um novo arquivo.
$output_file_name = ($version == 'c') ? ('message_eng.tpl') : ('script.tpl');
$output_file_name = "Scripts/$output_file_name";
file_put_contents($output_file_name, $contents);

echo "Arquivo combinado salvo como: $output_file_name\n";